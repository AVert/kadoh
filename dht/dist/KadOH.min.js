global._k=6,global._alpha=3,global._B=160,global._digest=Crypto.digest.SHA1
(function(a){var b=a;b.core={},b.core.Class=function(){function f(a){return j.call(g(a)?a:function(){},a,1)}function g(a){return typeof a===c}function h(a,b,c){return function(){var d=this.supr;this.supr=c[e][a];var f=b.apply(this,arguments);return this.supr=d,f}}function i(a,b,c){for(var f in b)b.hasOwnProperty(f)&&(a[f]=g(b[f])&&g(c[e][f])&&d.test(b[f])?h(f,b[f],c):b[f])}function j(a,b){function c(){}function l(){this.initialize?this.initialize.apply(this,arguments):(b||h&&d.apply(this,arguments),j.apply(this,arguments))}c[e]=this[e];var d=this,f=new c,h=g(a),j=h?a:this,k=h?{}:a;return l.methods=function(a){return i(f,a,d),l[e]=f,this},l.methods.call(l,k).prototype.constructor=l,l.extend=arguments.callee,l[e].implement=l.statics=function(a,b){return a=typeof a=="string"?function(){var c={};return c[a]=b,c}():a,i(this,a,d),this},l}var a=this,b=a.klass,c="function",d=/xyz/.test(function(){xyz})?/\bsupr\b/:/.*/,e="prototype";return f.noConflict=function(){return a.klass=b,this},a.klass=f,f}()})("object"==typeof module?module.exports:this.KadOH={})
(function(a){var b=a;b.Crypto={};var c=b.Crypto={},d=c.util={rotl:function(a,b){return a<<b|a>>>32-b},rotr:function(a,b){return a<<32-b|a>>>b},endian:function(a){if(a.constructor==Number)return d.rotl(a,8)&16711935|d.rotl(a,24)&4278255360;for(var b=0;b<a.length;b++)a[b]=d.endian(a[b]);return a},randomBytes:function(a){for(var b=[];a>0;a--)b.push(Math.floor(Math.random()*256));return b},bytesToWords:function(a){for(var b=[],c=0,d=0;c<a.length;c++,d+=8)b[d>>>5]|=a[c]<<24-d%32;return b},wordsToBytes:function(a){for(var b=[],c=0;c<a.length*32;c+=8)b.push(a[c>>>5]>>>24-c%32&255);return b},bytesToHex:function(a){for(var b=[],c=0;c<a.length;c++)b.push((a[c]>>>4).toString(16)),b.push((a[c]&15).toString(16));return b.join("")},hexToBytes:function(a){for(var b=[],c=0;c<a.length;c+=2)b.push(parseInt(a.substr(c,2),16));return b},XOR:function(a,b){if(a.length!=b.length)return;"string"==typeof a&&(a=d.hexToBytes(a)),"string"==typeof b&&(b=d.hexToBytes(b));var c=[];for(var e=0;e<a.length;e++)c.push(a[e]^b[e]);return c},distance:function(a,b){if(a===b)return 0;"string"==typeof a&&(a=d.hexToBytes(a)),"string"==typeof b&&(b=d.hexToBytes(b));var c=a.length;if(c!=b.length)return-1;var e=8*c;for(i=0;i<c;i++){var f=a[i]^b[i];if(f){for(var g=0;g<7;g++)if(f>>>7-g)break;return e-8*i-g}}return 0}},e=c.charenc={},f=c.charenc.Binary={stringToBytes:function(a){for(var b=[],c=0;c<a.length;c++)b.push(a.charCodeAt(c)&255);return b},bytesToString:function(a){for(var b=[],c=0;c<a.length;c++)b.push(String.fromCharCode(a[c]));return b.join("")}},g=c.charenc.UTF8={stringToBytes:function(a){return f.stringToBytes(unescape(encodeURIComponent(a)))},bytesToString:function(a){return decodeURIComponent(escape(f.bytesToString(a)))}},h=c.digest={SHA1:function(a,b){var c=d.wordsToBytes(h._sha1(a));return b&&b.asBytes?c:b&&b.asString?f.bytesToString(c):d.bytesToHex(c)},_sha1:function(a){a.constructor==String&&(a=g.stringToBytes(a));var b=d.bytesToWords(a),c=a.length*8,e=[],f=1732584193,h=-271733879,i=-1732584194,j=271733878,k=-1009589776;b[c>>5]|=128<<24-c%32,b[(c+64>>>9<<4)+15]=c;for(var l=0;l<b.length;l+=16){var m=f,n=h,o=i,p=j,q=k;for(var r=0;r<80;r++){if(r<16)e[r]=b[l+r];else{var s=e[r-3]^e[r-8]^e[r-14]^e[r-16];e[r]=s<<1|s>>>31}var t=(f<<5|f>>>27)+k+(e[r]>>>0)+(r<20?(h&i|~h&j)+1518500249:r<40?(h^i^j)+1859775393:r<60?(h&i|h&j|i&j)-1894007588:(h^i^j)-899497514);k=j,j=i,i=h<<30|h>>>2,h=f,f=t}f+=m,h+=n,i+=o,j+=p,k+=q}return[f,h,i,j,k]},_blocksize:16,_digestsize:20}})("object"==typeof module?module.exports:this.Crypto={})
var Node=Class.create({initialize:function(a,b,c){typeof c=="undefined"?this.id=this._generateId():this.id=c,this._routing_table=new RoutingTable(this.id)},_generateId:function(){return _digest(this.ip+":"+this.port)}})
var RoutingTable=Class.create({initialize:function(a){this._parent_id=a,this._kbuckets=[new KBucket(0,_B,a)]},distance:function(a){return Crypto.util.distance(this._parent_id,a)},addPeer:function(a){if(a.id==this._parent_id)return;var b=this._kbucketIndexFor(a.id),c=this._kbuckets[b];try{c.addPeer(a)}catch(d){if(c.isSplittable()){var e=c.split();e.addPeer(a),this._kbuckets.splice(b+1,0,e)}}},getPeer:function(a){var b=this._kbucketFor(a).getPeer(a);return b?b:!1},removePeer:function(a){return typeof a=="object"&&(a=a.getId()),this._kbucketFor(a).removePeer(a)},_kbucketIndexFor:function(a){dist=this.distance(a);for(var b=0;b<this._kbuckets.length;b++)if(this._kbuckets[b].distanceInRange(dist))return b;return!1},_kbucketFor:function(a){var b=this._keybucketIndexFor(a);return b?this._kbuckets[b]:!1}})
var KBucket=Class.create({initialize:function(a,b,c){this._min=typeof a=="undefined"?0:a,this._max=typeof b=="undefined"?_B:b,this._parent_id=c,this._size=0,this._distances=[],this._peers_ids=[],this._peers={}},addPeer:function(a){var b=this._peerExists(a);if(b!=0)this._updatePeer(a.getId());else if(this._size<_k)this._appendPeer(a);else throw console.error("The kbucket "+this.toString()+"is full"),new Error("FULL")},getPeer:function(a){var b=this._peerExists(a);return b===!1?!1:this._peers[b.id]},getPeers:function(a){if(typeof a=="undefined")return this._peers;a=Math.max(0,Math.min(a,this._size));var b=[],c=0,d=0;for(c=0;c<this._size;c++){if(d>=a)break;b.push(this._peers[c]),d++}return b},removePeer:function(a){var b=this._peerExists(a);return b===!1?!1:(delete this._peers_ids[b.index],delete this._peers[b.id],delete this._distances[b.id],this._size=this._peers_ids.length,!0)},idInRange:function(a,b){return this.distanceInRange(Crypto.util.distance(a,b))},distanceInRange:function(a){return this._min<=a&&a<this._max},getRange:function(){return{min:this._min,max:this._max}},setRange:function(a){this._min=a.min,this._max=a.max},setRangeMin:function(a){this._min=a},setRangeMax:function(a){this._max=a},split:function(){var a=(this._min+this._max)/2,b=new KBucket(this._min,a-1,this._parent_id);this.setRangeMin(a);var c,d=[];for(c=0;c<this._size;c++){var e=this._peers_ids[c],f=this._peers[e],g=this._distances[e];b.distanceInRange(g)&&(b.addPeer(f),d.push(e))}for(c=0;c<d.length;c++)this.removePeer(d[c]);return b},isSplittable:function(){return this.idInRange(this._parent_id)},toString:function(){return"<"+this._min+":"+this._max+"><#"+this._size+">"},_updatePeer:function(a){delete this._peer_ids[tuple.index],this._size=this._peer_ids.unshift(peer.getId())},_appendPeer:function(a){var b=a.getId();this._peers[b]=a,this._size=this._peers_ids.unshift(b),this._distances[b]=Crypto.util.distance(b,this._parent_id)},_peerExists:function(a){var b,c;return typeof a=="object"?(b=a.getId(),c=this._peers_ids.indexOf(b)):(b=a,c=this._peers_ids.indexOf(a)),c===-1?!1:{index:c,id:b}}})
var Peer=Class.create({initialize:function(a,b,c){this._ip=a,this._port=b,this._socket=a+":"+b,typeof c=="undefined"?this._id=this._generateId():this._id=c},getId:function(){return this._id},getSocket:function(){return this._socket},toString:function(){return"<"+this._id+"; "+this._socket+">"},_generateId:function(){return _digest(this._socket)}})