global._k=6,global._alpha=3,global._digest=Crypto.digest.SHA1
var Crypto=global.Crypto={},base64map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",util=Crypto.util={rotl:function(a,b){return a<<b|a>>>32-b},rotr:function(a,b){return a<<32-b|a>>>b},endian:function(a){if(a.constructor==Number)return util.rotl(a,8)&16711935|util.rotl(a,24)&4278255360;for(var b=0;b<a.length;b++)a[b]=util.endian(a[b]);return a},randomBytes:function(a){for(var b=[];a>0;a--)b.push(Math.floor(Math.random()*256));return b},bytesToWords:function(a){for(var b=[],c=0,d=0;c<a.length;c++,d+=8)b[d>>>5]|=a[c]<<24-d%32;return b},wordsToBytes:function(a){for(var b=[],c=0;c<a.length*32;c+=8)b.push(a[c>>>5]>>>24-c%32&255);return b},bytesToHex:function(a){for(var b=[],c=0;c<a.length;c++)b.push((a[c]>>>4).toString(16)),b.push((a[c]&15).toString(16));return b.join("")},hexToBytes:function(a){for(var b=[],c=0;c<a.length;c+=2)b.push(parseInt(a.substr(c,2),16));return b},bytesToBase64:function(a){if(typeof btoa=="function")return btoa(Binary.bytesToString(a));for(var b=[],c=0;c<a.length;c+=3){var d=a[c]<<16|a[c+1]<<8|a[c+2];for(var e=0;e<4;e++)c*8+e*6<=a.length*8?b.push(base64map.charAt(d>>>6*(3-e)&63)):b.push("=")}return b.join("")},base64ToBytes:function(a){if(typeof atob=="function")return Binary.stringToBytes(atob(a));a=a.replace(/[^A-Z0-9+\/]/ig,"");for(var b=[],c=0,d=0;c<a.length;d=++c%4){if(d==0)continue;b.push((base64map.indexOf(a.charAt(c-1))&Math.pow(2,-2*d+8)-1)<<d*2|base64map.indexOf(a.charAt(c))>>>6-d*2)}return b}},charenc=Crypto.charenc={},Binary=Crypto.charenc.Binary={stringToBytes:function(a){for(var b=[],c=0;c<a.length;c++)b.push(a.charCodeAt(c)&255);return b},bytesToString:function(a){for(var b=[],c=0;c<a.length;c++)b.push(String.fromCharCode(a[c]));return b.join("")}},UTF8=Crypto.charenc.UTF8={stringToBytes:function(a){return Binary.stringToBytes(unescape(encodeURIComponent(a)))},bytesToString:function(a){return decodeURIComponent(escape(Binary.bytesToString(a)))}},digest=Crypto.digest={SHA1:function(a,b){var c=util.wordsToBytes(digest._sha1(a));return b&&b.asBytes?c:b&&b.asString?Binary.bytesToString(c):util.bytesToHex(c)},_sha1:function(a){a.constructor==String&&(a=UTF8.stringToBytes(a));var b=util.bytesToWords(a),c=a.length*8,d=[],e=1732584193,f=-271733879,g=-1732584194,h=271733878,i=-1009589776;b[c>>5]|=128<<24-c%32,b[(c+64>>>9<<4)+15]=c;for(var j=0;j<b.length;j+=16){var k=e,l=f,m=g,n=h,o=i;for(var p=0;p<80;p++){if(p<16)d[p]=b[j+p];else{var q=d[p-3]^d[p-8]^d[p-14]^d[p-16];d[p]=q<<1|q>>>31}var r=(e<<5|e>>>27)+i+(d[p]>>>0)+(p<20?(f&g|~f&h)+1518500249:p<40?(f^g^h)+1859775393:p<60?(f&g|f&h|g&h)-1894007588:(f^g^h)-899497514);i=h,h=g,g=f<<30|f>>>2,f=e,e=r}e+=k,f+=l,g+=m,h+=n,i+=o}return[e,f,g,h,i]},_blocksize:16,_digestsize:20}
var Node=Class.create({initialize:function(a,b,c){typeof c=="undefined"?this.id=this._generateId():this.id=c,this._routing_table=new RoutingTable(this.id)},_generateId:function(){return _digest(this.ip+":"+this.port)}})
var RoutingTable=Class.create({initialize:function(a){this._parent_id=a,this._kbuckets=[new KBucket(0,Math.pow(2,160))]},distance:function(a,b){},addPeer:function(a){if(a.id==this._parent_id)return;try{var b=this._kbucketIndexFor(a.id)}catch(c){}},_kbucketIndexFor:function(a){for(kbucket in this._kbuckets);}})
var KBucket=Class.create({initialize:function(a,b){a=typeof a=="undefined"?0:a,b=typeof b=="undefined"?160:b,this._peers={}},idInRange:function(a){}})
var Peer=Class.create({initialize:function(a,b,c){this.address=a,this.port=b,typeof c=="undefined"?this.id=this._generateId():this.id=c},toString:function(){return"<"+this.id+"; "+this.address+":"+this.port+">"},_generateId:function(){return _digest(this.ip+":"+this.port)}})