<html>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script type="text/javascript" src="../../dist/KadOH.js"></script>

<script type="text/javascript">
$(function() {
  var KadOH = window.KadOH;
  node = undefined;

  function init(event) {
    var log = node ? false : true;
    node    = node || new KadOH.Node(null, {
      reactor: {
        transport: {
          jid: $('#login').val().trim() || 'kadoh@jabber.org',
          password: $('#password').val().trim() || 'azerty'
        }
      }
    });
    KadOH.log.subscribeTo(node, 'Node');
    KadOH.log.subscribeTo(node._reactor, 'Reactor')
    KadOH.log.subscribeTo(node._reactor._transport, 'Transport');
    event.preventDefault();
  }

  function connect(event) {
    node.connect();
    event.preventDefault();
  }

  function disconnect(event) {
    node.disconnect();
    event.preventDefault();
  }

  function join(event) {
    node.join(['alexstrat@jabber.org/kadoh', 'jinroh@jabber.org/kadoh']);
    event.preventDefault();
  }

  function ping(event) {
    try {
      var dst = $('#ping_dst').val();
      node.reactor().PING(new KadOH.Peer(dst));
    }
    catch(e) {
      console.error(e);
    }
    finally {
      event.preventDefault();
    }
  }

  $('#init').click(init);
  $('#connect').click(connect);
  $('#disconnect').click(disconnect);
  $('#join').click(join);
  $('#ping').click(ping);
});
</script>
<body>
<h2>Send message to node :</h2>
<form id='form'>
  <p>
    <input type="text" value="kadoh@jabber.org" name="login" id="login">
    <input type="password" value="azerty" name="password" id="password">
    <input type="submit" value="Init" name="init" id="init">
  </p>
  <p>
    <input type="submit" value="Connect" name="connect" id="connect">
    <input type="submit" value="Disconnect" name="disconnect" id="disconnect">
  </p>
  <p>
    <input type="submit" value="Join" name="join" id="join">
  </p>
  <p>
    <input type="text" name="ping_dst" id="ping_dst" value=""> 
    <input type="submit" value="Ping" name="ping" id="ping">
  </p>
</form>
</body>
</html>
